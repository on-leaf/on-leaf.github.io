---
layout: single
title:  "Review: Likelihood-based bilateral filters for pre-estimated basis sinograms using photon-counting CT"
category: "Paper review"
tag: [Computed tomography, CT, Photon counting CT, PCCT, Sinogram]
# header:
#   teaser: ../images/2025-07-08-CT_6/image-20250708184503610.png
toc: true
toc_sticky: true
toc_label: CONTENTS
toc_icon: "fa-solid fa-seedling" # More icons: https://fontawesome.com/v6/search?ic=free
author_profile: false
sidebar:
    nav: "counts"
search: true # Change true to false if you don't want to have this article be searched 
redirect_from:
    - /Paper review/PR_1
use_math: true
# published: false
---

**[Link to the paper]** <br>
[Likelihood-based bilateral filters for pre-estimated basis sinograms using photon-counting CT](https://pubmed.ncbi.nlm.nih.gov/36705079/)
{: .notice--success}

# Abstract
{% include start-box.html class="math-box"%}
$\bullet$ Background
: Photon-Counting CT (PCCT) is promising but suffers from noise amplification during material decomposition. Current noise-reduction methods often degrade spatial resolution and accuracy.

$\bullet$ Purpose
: This paper proposes a "Likelihood-Based Bilateral Filter" (LBF) which can be aplllied to pre-estimated basis sinogram. Unlike conventional filters that compare pixel intensity, this filter compares the statistical likelihood of neighboring measurements to more effectively reduce noise while preserving edges.

$\bullet$ Method
: 1.Perform maximum-likelihood (ML)-based estimation in the projection domain to obtain basis sinograms.<br><br>
: 2.Calculate the neighborhood likelihoods for a given measurement at the center pixel using the neighborhood estimates.<br><br>
: 3.Design the weights based on the distance of these likelihoods. Furthermore, the paper introduces two variations of this filter: one that uses statistical significance levels instead of empirical hyperparameters, and another measurement-based version applicable even without system models.

$\bullet$ Validation
: The proposed methods (the main LBF and its variations) were validated by analyzing the local property of noise and spatial resolution and the global trend of noise and bias. They were compared to the conventional neighborhood filters and the model-based iterative reconstruction with an edge-preserving penalty applied in the basis images.
{% include end-box.html %}

# 1.INTRODUCTION
{% include start-box.html class="math-box" font_size="0.9em"%}
Photon-counting coumputed tomography (PCCT) has great potential in many clinical applications via material decomposition.
- Diagnoising coronary artery calcification
- Diagnoising breast cancer
- Reducing metal artifacts while preserving an anatomical texture.
- Generate virtural noncontrast images for contrast-enhanced imaging
- Nano-particle agent distribution for target identificaiton

The maximum likelihood (ML) principle has been a gold standard for material decomposition due to the asymptotic efficiency.<br>

<div class="indented-paragraph">
The estimates are unbiased and achieve the Cramer-Rao lower bound (CRLB).<br>
However, because the CRLB is fundamentally dependent on the x-ray dose level, the low-dose used in clinical settings result in an inherently high noise. Consequently, ML-based estimates, despite their mathematical optimality, may fail to meet the quality standards required for clinical applications.
</div>

<hr/>

One may apply a regularizaiton with the ML criterion to reduce the noise in the estimates.<br>
<div class="indented-paragraph" markdown="1">
Edge-preserving functions such as (pseudo) Huber penalty.
</div>

The estimates are calculated iteratively, and it is called statistical iterative reconstruction (SIR) in this paper. 
- SIR can reduce the noise in the estimates
- Still, degradation of spatial resolution occurs
- Regularization affects the accuracy when the noise level is substantial

Recently, learing-based material decomposition has been an active research field. However, the robustness of the data mismatch needs to be addressed, and a sufficient number of training data is not always available.<br>
<div class="indented-paragraph" markdown="1">
Domain of training data and input data can be different.
</div>

This study assumes the latter case and focuses on traditional material decomposition.

<hr/>

Edge-preserving filtering in the image domain is another active reserach topic for spectral material decomposition. 
- HYPR-NLM: The modified local highlY constrained backPRojection reconstruction (HYPR-LR) for spectral CT by substituting the nonlocal mean (NLM) for the low-pass filtering (LPF) in HYPR-LR. 
- Dual-energy vectoriazaiton (DE-vec) and amplitude image-guided bilateral filter (BF) 
Both NLM and BF are effective edge-preserving denoising methods in the image processing field.

Both methods exploit neighborhood patches and pixels to reduce the noise while preserving structural information. However, when the noise level in the image is substantial, the may introduce bias due to lack of the noise statistics in the methods.<br>

<div class="indented-paragraph">
Both methods only use pixel difference without considering the underlying noise characteristics. 
This highlights a key limitation: because both filters operate 'blindly' to noise and rely only on apparent pixel values, they often misinterpret severe noise as genuine image features in high-noise environments. 
This misjudgment can lead to flawed filtering that ultimately distorts the image instead of cleaning it.
</div><br>

Furthermore, when the filters are applied to the bin-wise images, it is challenging to obtain noise statistics in the denoised images and perform unbiased material decomposition.

<div class="indented-paragraph" markdown="1">
This creates a two-fold problem for the subsequent material decomposition step:<br>
- Corruption of Noise Statistics: The original noise in each bin-wise image follows a predictable statistical distribution (e.g., Gaussian or Poisson). However, non-linear filters fundamentally alter these properties. The residual noise in the "denoised" image no longer follows a simple model; it becomes complex and statistically uncharacterized.
- Destruction of Noise Correlation: More critically, the noise across different energy channels is inherently correlated. Filtering each bin-wise image independently breaks this crucial inter-channel correlation.
</div>

<hr/>

This paper proposes statistical bilateral filtering algorithms in the sinogram domain. It is a post-processing method applied to the ML-based estimates of basis sinograms to reduce the noise in the estimates while minimally affecting spatial resolution and accuracy. In this paper, the following terms are defined as follows:

<div class="indented-paragraph" markdown="1">
- pixel: a specific position in the sinogram.
- pixel value: the associated ML-based estimates of the basis line integrals.
</div>

The conventional BF gives large weight to the neighborhood pixel, whose value is closer to the center pixel of interest. 

<figure style="display: flex; flex-direction: column; align-items: center; margin-top: 0.5em; margin-bottom: 0.5em;">
  <img src="../images/2025-07-14-PR_1/image-20250721123527356.png" alt="Illustration of photoelectric interaction" 
       style="width: 70%; height: auto;">
   <figcaption style="font-size: 20px; margin-top: -0.5em;">
   Fig.1 An example of the ground truth of the basis sinograms of water and bone and the associated ML-based estimates for the abdominal phantom used in the simulation study. An example of a $3\times3$ window centered at pixel j is also shown at the bottom left. ML, maximum likelihood.
   </figcaption>
</figure> 

However, as shown in Fig.1, the ML-based estimates have a large variations.
<div class="indented-paragraph" markdown="1">
It indicates that pixel value-dependent filtering like the BF will be futile.
</div>

The proposed filter uses neighborhood likelohoods instead of pixel value-dependent weights. It is called a likelihood-based bilateral filter (LBF). For example, Fig.2 illustrates a toy example of the two-material decomposition of water and bone; a two-dimensinal object and a one-dimensional sinogram.

<figure style="display: flex; flex-direction: column; align-items: center; margin-top: 0.5em; margin-bottom: 0.5em;">
  <img src="../images/2025-07-14-PR_1/image-20250721125042630.png" alt="Illustration of photoelectric interaction" 
       style="width: 40%; height: auto;">
   <figcaption style="font-size: 20px; margin-top: -0.5em;">
   Fig.2 An illustration of a toy example for the ML-based estimates of the water and bone (one-dimensional sinogram) and the corresponding neighborhood likelihoods when the center pixel is j. (The brighter the pixel, it intends the less value for the thickness and the likelihood).ML, maximum likelihood.
   </figcaption>
</figure> 

The ML-based estimator can be applied to each photon-counting detector (PCD) measurement and produce the estimates of line integrals for water (blue) and bone (yellow-red). Suppose the center pixel is indexed by $j$. In that case, it is desirable to have a large weight at $j-1$ and a small at $j+1$ to reduce the noise while preserving spatial resolution and accuracy (the ground truth of the basis line integral is only different at the pixel $j+1$). However, in practice, the information for the ground truth is unknown. 
<div class="indented-paragraph" markdown="1">
So, the LBF considers the PCD measurements at the center (the shaded area in Fig.2) as a sample observation from the unknown population parameter (the ground truth of the basis line integrals at $j$) and calculates the corresponding neighborhood likelihoods using the ML-based estimates.
</div>

{% include end-box.html %}



















# 2.METHODS
{% include start-box.html class="math-box" font_size="0.9em"%}
{% include end-box.html %}

# 3.SIMULATION SETTINGS
{% include start-box.html class="math-box" font_size="0.9em"%}
{% include end-box.html %}

# 4.RESULTS
{% include start-box.html class="math-box" font_size="0.9em"%}
{% include end-box.html %}

# 5.DISCUSSIONS AND CONCLUSIONS
{% include start-box.html class="math-box" font_size="0.9em"%}
{% include end-box.html %}