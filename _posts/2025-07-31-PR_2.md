---
layout: single
title:  "Review: Multi-energy inter-pixel coincidence counters for charge sharing correction and compensation in photon counting detectors"
category: "Paper review"
tag: [Computed tomography, CT, Photon counting CT, PCCT, Charge sharing, Photon counting detector, PCD]
# header:
#   teaser: ../images/2025-07-08-CT_6/image-20250708184503610.png
toc: true
toc_sticky: true
toc_label: CONTENTS
toc_icon: "fa-solid fa-seedling" # More icons: https://fontawesome.com/v6/search?ic=free
author_profile: false
sidebar:
    nav: "counts"
search: true # Change true to false if you don't want to have this article be searched 
redirect_from:
    - /Paper review/PR_2
use_math: true
# published: false
---

**[Link to the paper]** <br>
[Multi-energy inter-pixel coincidence counters for charge sharing correction and compensation in photon counting detectors](https://pubmed.ncbi.nlm.nih.gov/31984498/)
{: .notice--success}

# Abstract
{% include start-box.html class="math-box"%}
$\bullet$ Purpose
: Smaller pixel sizes of x-ray photon counting detectors (PCDs) have
  <div class="indented-paragraph" markdown="1">
  Advantages
  - Better count rate capability
  </div>

  <div class="indented-paragraph" markdown="1">
  Disadvantages
  - Charge sharing (The split of an x-ray photon energy) 
    <div class="indented-paragraph" markdown="1">

    - One photon may produce two or more counts at adjacent pixels
    - 90keV photon can be measured as 30keV and 90keV
    - Hard to fix position of measured photon
  </div>

  This "double-counting" produced by charge sharing increases noise variance and degrades the spectral response. 
  In this reason, charge sharing has negative impact on the PCD-based computed tomography (CT) performance.
  But, charge sharing is impossible to avoid. (It is induced by the detection physics and occurs regardless of count rates)
  In this paper, a method that has a potential to address both noise and bias added by charge sharing is proposed.

$\bullet$ Methods
: In this paper, a multi-energy inter-pixel coincidence cunter (MEICC) technique is proposed.
  This technique uses energy-dependent coincidence counters, keeps the book of charge sharing envents during data acquisition and provieds the exact number of charge sharing occurrences, which can be used to either correct of compensate for them after the acquisition is completed.
  <div class="indented-paragraph" markdown="1">
  This process does not interfere with the primary couting process
  </div>
  Authors evaluated Cramer-Rao lower bound (CRLB) of PCDs with and without MEICC using Monte Carlo simulation.

{% include end-box.html %}


# 1. Introduction
{% include start-box.html class="math-box"%}
## 1-1) Charge sharing in photon counting detectors (PCDs)
Photon counting detector-based x-ray computed tomography (PCD-CT) has many advantages. 

<div class="indented-paragraph" markdown="1">
- Higher spatial resolution
- Better soft tissue contrast
- Stronger contrast agent enhancement
- Radiation dose reduction
- Quantitative CT imaging and biomarkers
- Accurate soft tissue material characteriazaiton 
- K-edge imaging
- Simultaneous multi-contrast agent imaging
</div>

However, the performnace of the prototype PCD-CT did not meet high expectations because of a "charge sharing" or spatio-energetic corss talk between PCD pixels.

<figure style="display: flex; flex-direction: column; align-items: center; margin-top: 0.5em; margin-bottom: 0.5em;">
  <img src="../images/2025-07-31-PR_2/image-20250804105650462.png" alt="Illustration of photoelectric interaction" 
       style="width: 50%; height: auto;">
   <figcaption style="font-size: 20px; margin-top: -0.5em;">
   Fig.1. Charge sharing.
   </figcaption>
</figure> 

In this paper, charge sharing includes fluoresence x-ray emission and its reabsorption.

<div class="indented-paragraph" markdown="1">
Split of the energy of an incident x-ray photon into multiple charge clouds onto different pixels.
</div>

<figure style="display: flex; flex-direction: column; align-items: center; margin-top: 0.5em; margin-bottom: 0.5em;">
  <img src="../images/2025-07-31-PR_2/image-20250804105714691.png" alt="Illustration of photoelectric interaction" 
       style="width: 60%; height: auto;">
   <figcaption style="font-size: 20px; margin-top: -0.5em;">
   Fig.2. Three charge sharing cases.
   </figcaption>
</figure> 

When an x-ray photon hits a detector pixel,  

<div class="indented-paragraph" markdown="1">
No charge sharing
: PCD adds one count to an energy window that corresponds to the photon's energy (Fig. 2A).
</div>

<div class="indented-paragraph" markdown="1">
Charge sharing (Most cases)
: The energy of the x-ray photon is split between two adjacecnt pixels, which produce two counts at lower energies (Fig. 2B-2C).
This is called double-counting and it increases noise variance, degrades the spatial resolution, and degrades the energy response.
</div>

In some cases, the realistic PCD-CT was comparable to or even worse than dual-energy CT.
Addressing the charge sharing will create PCDs close to the perfect PCD with decreased noise, enhanced signals, and improved image quality overall.

Charge sharing is impossible to avoid because it is inherent to the detection physics.
A probability of charge sharing is ~70% with a pixel size of 225$\mu$m.
Larger pixel size could decrease the probability and mitigate charge sharing. 
However, larger pixel size increases the x-ray photon's incoming rate per pixel and exacerbates the problem of "pulse pileup".

<div class="indented-paragraph" markdown="1">
Given the current detector speed and x-ray intensity for clinical CT, the pixel size probably needs to be smaller than 500 $\mu$m, and consequently, charge sharing needs to be addressed.
</div>

## 1-2) PCDs with charge sharing correction and compensation schemes
Detectors that handle charge sharing have been proposed and many patents have been filed.
Their shemes can be categorized into two groups.

<div class="indented-paragraph" markdown="1">
An event-based real-time charge sharing correction/rejection
- Event-based real-time charge sharing correction
: There are two types of correction - analog and digital. However, both versions are inherently and intricately integrated with the primary couting process, and there is a concern that it would degrade PCD's counting capability at high count rates.

- Event-based real-time charge sharing rejection
: These PCDs reject charge shared events by separating them from non-charge shared events. This have fewer processes than charge sharing correction schemes, therefore, can be more efficient. However, by setting aside any coincidence events, this approach may exclude too many photons including spill-out charge sharing.
</div>

<div class="indented-paragraph" markdown="1">
A reading-based post-acquisition correction/compensation
- Reading-based post-acquisition charge sharing correction
: These schems simply record additional information and are independent of the primary counting process. 
They include one coincidence counter presented by Hsieh and a list-mode acquisition.
<div class="indented-paragraph" markdown="1">
- One coincidence counter
: Hsieh proposed to add one coincidence counter per pixel to the standard PCD in order to count the number of double-counting events with four neighboring pixels. It is intriguing but with no energy resolution in the coincidence counter, it cannot tell how many events were spill-in and how many were spill-out, nor can it tell how many counts went into each energy window. Therefore, its ability to correct for charge sharing is of interset and authors assessed the performance of this approach compairng with the their proposed method.

- List-mode acquisition
</div>

- Model-based post-acquisition charge sharing compensation
: This algorithm is a software solution. This algorithms can address the bias using a charge sharing model. However, they cannot estimate the noise added by charge sharing. Thus, the signal-to-noise ratio of the processed data is expected to be worse than what would be achieved by PCDs without charge sharing.
</div>

In this paper, authours proposed a reading-based post-acquisition correction/compensation method to address both noise and bias added by charge sharing.
The design concept is similar to the one coincidence counter method proposed by Hsieh, but the method proposed here keeps spectral information in charge sharing (while method of Hsieh records intensity information only). 

This paper is organized as follows:

<div class="indented-paragraph" markdown="1">
- Section 2: Proposed method, Monte Carlo (MC) simulation program and evaluation methods will be introduced.
- Section 3: Results
- Section 4: Disscusion and Colclusion 
</div>

{% include end-box.html %}

# 2. Methods
{% include start-box.html class="math-box"%}



{% include end-box.html %}
