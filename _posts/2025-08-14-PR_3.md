---
layout: single
title:  "Review: An Algorithm for Noise Suppression in Dual Energy CT Material Density Images"
category: "Paper review"
tag: [Computed tomography, CT, Dual energy CT, Noise]
# header:
#   teaser: ../images/2025-07-08-CT_6/image-20250708184503610.png
toc: true
toc_sticky: true
toc_label: CONTENTS
toc_icon: "fa-solid fa-seedling" # More icons: https://fontawesome.com/v6/search?ic=free
author_profile: false
sidebar:
    nav: "counts"
search: true # Change true to false if you don't want to have this article be searched 
redirect_from:
    - /Paper review/PR_3
use_math: true
# published: false
---

**[Link to the paper]** <br>
[An Algorithm for Noise Suppression in Dual Energy CT Material Density Images](https://ieeexplore.ieee.org/abstract/document/7785)
{: .notice--success}

# Abstract
{% include start-box.html class="math-box"%}
Dual energy material density images obtained by prereconstrucion basis material decomposition techniques offer specific tissue information, but they exhibit relatively high pixel noise. 
This paper show that noise in the material density images in negatively correlated and that can be exploited for noise reduction in the two basis material density images.
Authors proposed algorithm using negative correlation property.
This algorithm minimizes noise-related differences between pixels and their local mean values adgering to the constraint that monoenergetic CT values which have to remain unchanged.
When this algorithm applied to the material density images, a noise reduction by factors of 2 to 5 is achieved.
However, edge effects occured in the processed images. 
To suppress these, authors added locally adaptive algorithms.  
{% include end-box.html %}

# 1. Introduction
{% include start-box.html class="math-box"%}
In general, dual energy techniques in X-ray CT offer additionaly and more specific information on the object than single energy techniques.
While standard CT yields linear attenuation coefficient (LAC) images, dual energy basis material decomposition techniques provide separate density images of the high and low atomic number materials (e.g., bone and water).
It seems to good to use dual energy rather than standard CT, however, images obtained by dual energy basis material decomposition suffer from high pixel noise levels.

Of coures, these noise can be reduce by an increase in exposure.
However, any noise reduction by a factor of $n$ requires an exposure increase by a factor of $n^2$ and it is not a good choice.
In this reason, the clinical use of dual energy methods has been restricted.

To reduce noise without an increase in exposure, many study are investigated.
One of them is reported by Macovski $\textit{et al}$.
Their basic idea was to reduce noise in a material-specific image $A$ by a low-pass filter operation and to restore structural information by superimposing a high-pass filtred version of a low-nosie, unspecific image $B$

<center>$$A' = A_{\text{low}} + C \cdot B_{\text{high}} \tag{1}$$</center>

The quality of the resultant image $A'$ depended on the control function $C$ which served for scailing and locally adapting this process.
Authors decided not to follow this approach because they wanted to conserve quantitative information.
<div class="indented-paragraph" markdown="1">

- Since the noise has randomness, noise can be compensated each other (high and low noise) when mean value of enough number of pixels is calcuated
- In method of Macovski, the balance of high and low noise can be break because of mixing of two images
</div>
Authors consider this mandatory for dual energy CT which above all is a quantitative technique.
The concept of them obeys the constraint that quantitative values for any meaningful ROI remain unchanged.
Their proposed method is tailored to material density images obtained by prereconstruction basis material decomposition techniques since it exploits the negative correlation between pixel noise in the two density images.
{% include end-box.html %}

# 2. Pixel noise correlations in basis material density images
{% include start-box.html class="math-box"%}
## 2-1) The basis material decomposition method
X-ray attenuation in the diagnostic energy range is mostly due to photoelectric effect (absorption) and Compton effect (incoherent scattering).
<div class="indented-paragraph" markdown="1">
These effects can be viewd as linearly independent functions of energy. 
</div>
There are known fact from Alvarez and Macovski that the mass atteunation coefficient (MAC) $\frac{\mu}{\rho} (E)$ of any material can be expressed as a linear combination of these two basis functions to a good approximation.
<div class="indented-paragraph" markdown="1">
Furthre on, that alternatively the MAC functions of any two materials, which differ sufficiently in their atomic number $Z$, can equally be used as basis functions
</div>

For any arbitrary object, the line integral over the linear attenuation coefficient $\int \mu (\vec{r}, E) \mathrm{d}s$ can be expressed accordingly as

<center>$$\int \mu (\vec{r}, E) \mathrm{d}s = \left( \frac{\mu}{\rho}_1\right)(E) \cdot \delta_1 + \left( \frac{\mu}{\rho}_2\right)(E) \cdot \delta_2 \tag{2}$$</center>

with 

<center>$$\delta_i = \int \rho_i (\vec{r}) \mathrm{d}s \quad i=1,2. \tag{3}$$</center>
$\delta_i$ represents the area density in $g/cm^2$ and $\rho_i (\vec{r})$ the local density in $g/cm^3$ of basis material $i$.

In dual energy methods, attenuation is measured for two different energies or X-ray spectra which yields two non-linear equations for each ray path 

<center>$$I_h(\delta_1, \delta_2) = \int I_{0h}(E) \cdot e^{-(\mu/\rho)_1 (E) \cdot \delta_1 - (\mu/\rho)_2 (E) \cdot \delta_2} \mathrm{d}E \tag{4a}$$</center>
<center>$$I_l(\delta_1, \delta_2) = \int I_{0l}(E) \cdot e^{-(\mu/\rho)_1 (E) \cdot \delta_1 - (\mu/\rho)_2 (E) \cdot \delta_2} \mathrm{d}E \tag{4b}$$</center>

$I$ and $I_0$ are the attenuated and primary intensities, respectively, the subscripts $h$ and $l$ refer to the high- and low- kVp sepctra.
The basis material decomposition method has to solve this pair of equations for the two unknown area densities $\delta_1$ and $\delta_2$ using appropriate calibration measurements or calcuations. 
Here, a pair of attenuation values can be transformed into a pair of density values by defining atteunuation $S := \ln \left(\frac{I_0}{I}\right)$.
<div class="indented-paragraph" markdown="1">
$$(S_h, S_l) \Rightarrow (\delta_1, \delta_2)$$
</div>

## 2-2) Mathematical description of noise propagation
The variance of the $\delta_i$ is defined as 

<center>$$\sigma_{i}^{2} := \text{Var}(\delta_i) = E[(\mathrm{d}\delta_i)^2] \tag{5}$$</center>
where
<center>$$\mathrm{d}\delta_i = \left( \frac{\partial \delta_i}{\partial S_h} \right) \cdot \mathrm{d}S_h + \left( \frac{\partial \delta_i}{\partial S_l} \right) \cdot \mathrm{d}S_l \quad (i=1,2) \tag{6}$$</center>
are the differential of the transformation.



{% include end-box.html %}

# 3. Algorithms for noise reduction 
{% include start-box.html class="math-box"%}
## 3-1) Basic algorithm

## 3-2) Adaptive algorithms
{% include end-box.html %}


# 4. Implementation and validation 
{% include start-box.html class="math-box"%}
{% include end-box.html %}

# 5. Results 
{% include start-box.html class="math-box"%}
{% include end-box.html %}

# 6. Disscussion 
{% include start-box.html class="math-box"%}
{% include end-box.html %}